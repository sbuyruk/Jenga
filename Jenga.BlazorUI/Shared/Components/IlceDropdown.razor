@using Blazorise
@using Jenga.DataAccess.Repositories.IRepository
@using Jenga.Models.Ortak
@using Jenga.Models.TBYS
@inject IUnitOfWork UnitOfWork

<Select TValue="int?" Value="Value" ValueChanged="ValueChanged" ValueExpression="ValueExpression" Class="">
    <option value="">Seçiniz</option>
    @if (ilceler != null)
    {
        @foreach (var ilce in ilceler)
        {
            <option value="@ilce.Id">@ilce.IlceAdi</option>
        }
    }
</Select>

@code {
    [Parameter] public int? IlId { get; set; } // İl Id'si
    [Parameter] public int? Value { get; set; } // Seçilen İlçe Id
    [Parameter] public EventCallback<int?> ValueChanged { get; set; }
    [Parameter] public Expression<Func<int?>>? ValueExpression { get; set; }

    private List<Ilce>? ilceler;


    protected override async Task OnParametersSetAsync()
    {
        if (IlId.HasValue)
        {
            Console.WriteLine($"IlId değişti: {IlId}"); // Debug için
            ilceler = (await UnitOfWork.Ilce.GetAllByFilterAsync(x => x.IlId == IlId)).ToList();
        }
        else
        {
            Console.WriteLine("IlId boş, ilçe listesi temizleniyor."); // Debug için
            ilceler = new List<Ilce>(); // İl Id yoksa boş liste
        }
    }

}
